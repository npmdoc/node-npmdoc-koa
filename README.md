# api documentation for  [koa (v2.2.0)](https://github.com/koajs/koa#readme)  [![travis-ci.org build-status](https://api.travis-ci.org/npmdoc/node-npmdoc-koa.svg)](https://travis-ci.org/npmdoc/node-npmdoc-koa)
#### Koa web app framework

[![NPM](https://nodei.co/npm/koa.png?downloads=true)](https://www.npmjs.com/package/koa)

[![apidoc](https://npmdoc.github.io/node-npmdoc-koa/build/screen-capture.buildNpmdoc.browser._2Fhome_2Ftravis_2Fbuild_2Fnpmdoc_2Fnode-npmdoc-koa_2Ftmp_2Fbuild_2Fapidoc.html.png)](https://npmdoc.github.io/node-npmdoc-koa/build..beta..travis-ci.org/apidoc.html)

![package-listing](https://npmdoc.github.io/node-npmdoc-koa/build/screen-capture.npmPackageListing.svg)



# package.json

```json

{
    "bugs": {
        "url": "https://github.com/koajs/koa/issues"
    },
    "contributors": [
        {
            "name": "TJ Holowaychuk",
            "email": "tj@vision-media.ca"
        },
        {
            "name": "Jonathan Ong",
            "email": "jonathanrichardong@gmail.com"
        },
        {
            "name": "dead_horse",
            "email": "dead_horse@qq.com"
        },
        {
            "name": "Tejas Manohar",
            "email": "me@tejas.io"
        },
        {
            "name": "Yiyu He",
            "email": "dead_horse@qq.com"
        },
        {
            "name": "fengmk2",
            "email": "fengmk2@gmail.com"
        },
        {
            "name": "Julian Gruber",
            "email": "julian@juliangruber.com"
        },
        {
            "name": "Jonathan Ong",
            "email": "me@jongleberry.com"
        },
        {
            "name": "fengmk2",
            "email": "m@fengmk2.com"
        },
        {
            "name": "Rui Marinho",
            "email": "rpm@seegno.com"
        },
        {
            "name": "jongleberry",
            "email": "jonathanong@users.noreply.github.com"
        },
        {
            "name": "pana",
            "email": "pana.wang@outlook.com"
        },
        {
            "name": "Ian Storm Taylor",
            "email": "ian@ianstormtaylor.com"
        },
        {
            "name": "PatrickJS",
            "email": "github@gdi2290.com"
        },
        {
            "name": "Sonny Piers",
            "email": "sonny@fastmail.net"
        },
        {
            "name": "alsotang",
            "email": "alsotang@gmail.com"
        },
        {
            "name": "Jesús Rodríguez Rodríguez",
            "email": "Foxandxss@gmail.com"
        },
        {
            "name": "Bryan Bess",
            "email": "squarejaw@bsbess.com"
        },
        {
            "name": "Robert Sköld",
            "email": "robert@publicclass.se"
        },
        {
            "name": "yoshuawuyts",
            "email": "i@yoshuawuyts.com"
        },
        {
            "name": "Johan Bergström",
            "email": "bugs@bergstroem.nu"
        },
        {
            "name": "Karl Böhlmark",
            "email": "karl.bohlmark@gmail.com"
        },
        {
            "name": "Kenneth Ormandy",
            "email": "kenneth@chloi.io"
        },
        {
            "name": "Kim Joar Bekkelund",
            "email": "kjbekkelund@gmail.com"
        },
        {
            "name": "Kyle Suss",
            "email": "susskyle@gmail.com"
        },
        {
            "name": "Matheus Azzi",
            "email": "matheuslazzi@gmail.com"
        },
        {
            "name": "Mathieu Gallé-Tessonneau",
            "email": "mathieu.galletessonneau@gmail.com"
        },
        {
            "name": "Matthew Chase Whittemore",
            "email": "matthew@socialtables.com"
        },
        {
            "name": "Matthew King",
            "email": "mking@users.noreply.github.com"
        },
        {
            "name": "Matthew Mueller",
            "email": "mattmuelle@gmail.com"
        },
        {
            "name": "Michaël Zasso",
            "email": "mic.besace@gmail.com"
        },
        {
            "name": "Nathan Rajlich",
            "email": "nathan@tootallnate.net"
        },
        {
            "name": "New Now Nohow",
            "email": "empty@cqdr.es"
        },
        {
            "name": "Peeyush Kushwaha",
            "email": "peeyush.p97@gmail.com"
        },
        {
            "name": "Phillip Alexander",
            "email": "git@phillipalexander.io"
        },
        {
            "name": "Qiming zhao",
            "email": "chemzqm@gmail.com"
        },
        {
            "name": "Ryunosuke SATO",
            "email": "tricknotes.rs@gmail.com"
        },
        {
            "name": "Sterling Williams",
            "email": "sterlingw@qualtrics.com"
        },
        {
            "name": "Teoman Soygul",
            "email": "teo@soygul.com"
        },
        {
            "name": "Tiago Ribeiro",
            "email": "tlr@seegno.com"
        },
        {
            "name": "Tim Schaub",
            "email": "tim.schaub@gmail.com"
        },
        {
            "name": "Travis Jeffery",
            "email": "tj@travisjeffery.com"
        },
        {
            "name": "Veselin Todorov",
            "email": "veselin@veselin.bg"
        },
        {
            "name": "Yazhong Liu",
            "email": "l900422@vip.qq.com"
        },
        {
            "name": "Yazhong Liu",
            "email": "yorkiefixer@gmail.com"
        },
        {
            "name": "Yoshua Wuyts",
            "email": "yoshuawuyts@gmail.com"
        },
        {
            "name": "bhanuc",
            "email": "bhanuc@iitk.ac.in"
        },
        {
            "name": "fundon",
            "email": "cfddream@gmail.com"
        },
        {
            "name": "gyson",
            "email": "eilian.yunsong@gmail.com"
        },
        {
            "name": "haoxin",
            "email": "coderhaoxin@outlook.com"
        },
        {
            "name": "jeromew",
            "email": "jerome.wagner@m4x.org"
        },
        {
            "name": "llambda",
            "email": "xxgsoftware@gmail.com"
        },
        {
            "name": "mako-taco",
            "email": "jake.y.scott@gmail.com"
        },
        {
            "name": "mdemo",
            "email": "mds@xue.bi"
        },
        {
            "name": "nicoder",
            "email": "nicolas.dermine@gmail.com"
        },
        {
            "name": "superchink",
            "email": "superchink@gmail.com"
        },
        {
            "name": "tmilewski",
            "email": "tmilewski@gmail.com"
        },
        {
            "name": "yosssi",
            "email": "yoshida.keiji.84@gmail.com"
        },
        {
            "name": "Aaron Heckmann",
            "email": "aaron.heckmann+github@gmail.com"
        },
        {
            "name": "zensh",
            "email": "admin@zensh.com"
        },
        {
            "name": "Adam L",
            "email": "skyros@gmail.com"
        },
        {
            "name": "AlexeyKhristov",
            "email": "AlexeyKhristov@users.noreply.github.com"
        },
        {
            "name": "Ben Reinhart",
            "email": "breinhart@groupon.com"
        },
        {
            "name": "C.T. Lin",
            "email": "chentsulin@gmail.com"
        },
        {
            "name": "Chris Tarquini",
            "email": "chris@ilsken.com"
        },
        {
            "name": "Christoffer Hallas",
            "email": "hallas@users.noreply.github.com"
        },
        {
            "name": "Darren Cauthon",
            "email": "darren@cauthon.com"
        },
        {
            "name": "Debjeet Biswas",
            "email": "debjeet@vxtindia.com"
        },
        {
            "name": "Dmitry Mazuro",
            "email": "dmitry.mazuro@icloud.com"
        },
        {
            "name": "Douglas Christopher Wilson",
            "email": "doug@somethingdoug.com"
        },
        {
            "name": "Eivind Fjeldstad",
            "email": "eivind.fjeldstad@gmail.com"
        },
        {
            "name": "Guilherme Pacheco",
            "email": "guilherme.f.pacheco@hotmail.com"
        },
        {
            "name": "HanHor Wu",
            "email": "hanhor.wu@gmail.com"
        },
        {
            "name": "Hugh Kennedy",
            "email": "hughskennedy@gmail.com"
        },
        {
            "name": "Jan Buschtöns",
            "email": "buschtoens@gmail.com"
        },
        {
            "name": "Jan Carlo Viray",
            "email": "virayjancarlo@yahoo.com"
        },
        {
            "name": "Jed Schmidt",
            "email": "where@jed.is"
        },
        {
            "name": "Jesus Rodriguez",
            "email": "foxandxss@gmail.com"
        },
        {
            "name": "Jingwei \"John\" Liu",
            "email": "liujingwei@gmail.com"
        }
    ],
    "dependencies": {
        "accepts": "^1.2.2",
        "content-disposition": "~0.5.0",
        "content-type": "^1.0.0",
        "cookies": "~0.7.0",
        "debug": "*",
        "delegates": "^1.0.0",
        "depd": "^1.1.0",
        "destroy": "^1.0.3",
        "error-inject": "~1.0.0",
        "escape-html": "~1.0.1",
        "fresh": "^0.5.0",
        "http-assert": "^1.1.0",
        "http-errors": "^1.2.8",
        "is-generator-function": "^1.0.3",
        "koa-compose": "^3.0.0",
        "koa-convert": "^1.2.0",
        "koa-is-json": "^1.0.0",
        "mime-types": "^2.0.7",
        "on-finished": "^2.1.0",
        "only": "0.0.2",
        "parseurl": "^1.3.0",
        "statuses": "^1.2.0",
        "type-is": "^1.5.5",
        "vary": "^1.0.0"
    },
    "description": "Koa web app framework",
    "devDependencies": {
        "babel-eslint": "^7.1.1",
        "eslint": "^3.17.1",
        "eslint-config-standard": "^7.0.1",
        "eslint-plugin-babel": "^4.1.1",
        "eslint-plugin-promise": "^3.5.0",
        "eslint-plugin-standard": "^2.1.1",
        "istanbul": "^0.4.0",
        "mocha": "^3.2.0",
        "should": "^6.0.3",
        "should-http": "0.0.3",
        "supertest": "^3.0.0",
        "test-console": "^0.7.1"
    },
    "directories": {},
    "dist": {
        "shasum": "b055933187849d540ad8b9f731baaa4be97c652d",
        "tarball": "https://registry.npmjs.org/koa/-/koa-2.2.0.tgz"
    },
    "engines": {
        "node": ">= 6.0.0"
    },
    "files": [
        "lib"
    ],
    "gitHead": "9a9949f9eef95fbe95e11ada5b677dd7aa284fce",
    "homepage": "https://github.com/koajs/koa#readme",
    "keywords": [
        "web",
        "app",
        "http",
        "application",
        "framework",
        "middleware",
        "rack"
    ],
    "license": "MIT",
    "main": "lib/application.js",
    "maintainers": [
        {
            "name": "aheckmann",
            "email": "aaron.heckmann+github@gmail.com"
        },
        {
            "name": "coderhaoxin",
            "email": "coderhaoxin@outlook.com"
        },
        {
            "name": "dead-horse",
            "email": "dead_horse@qq.com"
        },
        {
            "name": "dead_horse",
            "email": "dead_horse@qq.com"
        },
        {
            "name": "eivifj",
            "email": "eivind.fjeldstad@gmail.com"
        },
        {
            "name": "fengmk2",
            "email": "fengmk2@gmail.com"
        },
        {
            "name": "jongleberry",
            "email": "jonathanrichardong@gmail.com"
        },
        {
            "name": "juliangruber",
            "email": "julian@juliangruber.com"
        },
        {
            "name": "tjholowaychuk",
            "email": "tj@vision-media.ca"
        }
    ],
    "name": "koa",
    "optionalDependencies": {},
    "readme": "ERROR: No README data found!",
    "repository": {
        "type": "git",
        "url": "git+https://github.com/koajs/koa.git"
    },
    "scripts": {
        "test": "make test"
    },
    "version": "2.2.0"
}
```



# <a name="apidoc.tableOfContents"></a>[table of contents](#apidoc.tableOfContents)

#### [module koa](#apidoc.module.koa)
1.  object <span class="apidocSignatureSpan">koa.</span>context
1.  object <span class="apidocSignatureSpan">koa.</span>request
1.  object <span class="apidocSignatureSpan">koa.</span>response

#### [module koa.context](#apidoc.module.koa.context)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>accepts ()](#apidoc.element.koa.context.accepts)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>acceptsCharsets ()](#apidoc.element.koa.context.acceptsCharsets)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>acceptsEncodings ()](#apidoc.element.koa.context.acceptsEncodings)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>acceptsLanguages ()](#apidoc.element.koa.context.acceptsLanguages)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>append ()](#apidoc.element.koa.context.append)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>assert (value, status, msg, opts)](#apidoc.element.koa.context.assert)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>attachment ()](#apidoc.element.koa.context.attachment)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>flushHeaders ()](#apidoc.element.koa.context.flushHeaders)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>get ()](#apidoc.element.koa.context.get)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>inspect ()](#apidoc.element.koa.context.inspect)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>is ()](#apidoc.element.koa.context.is)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>onerror (err)](#apidoc.element.koa.context.onerror)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>redirect ()](#apidoc.element.koa.context.redirect)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>remove ()](#apidoc.element.koa.context.remove)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>set ()](#apidoc.element.koa.context.set)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>throw ()](#apidoc.element.koa.context.throw)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>toJSON ()](#apidoc.element.koa.context.toJSON)
1.  [function <span class="apidocSignatureSpan">koa.context.</span>vary ()](#apidoc.element.koa.context.vary)

#### [module koa.request](#apidoc.module.koa.request)
1.  [function <span class="apidocSignatureSpan">koa.request.</span>accepts ()](#apidoc.element.koa.request.accepts)
1.  [function <span class="apidocSignatureSpan">koa.request.</span>acceptsCharsets ()](#apidoc.element.koa.request.acceptsCharsets)
1.  [function <span class="apidocSignatureSpan">koa.request.</span>acceptsEncodings ()](#apidoc.element.koa.request.acceptsEncodings)
1.  [function <span class="apidocSignatureSpan">koa.request.</span>acceptsLanguages ()](#apidoc.element.koa.request.acceptsLanguages)
1.  [function <span class="apidocSignatureSpan">koa.request.</span>get (field)](#apidoc.element.koa.request.get)
1.  [function <span class="apidocSignatureSpan">koa.request.</span>inspect ()](#apidoc.element.koa.request.inspect)
1.  [function <span class="apidocSignatureSpan">koa.request.</span>is (types)](#apidoc.element.koa.request.is)
1.  [function <span class="apidocSignatureSpan">koa.request.</span>toJSON ()](#apidoc.element.koa.request.toJSON)
1.  object <span class="apidocSignatureSpan">koa.request.</span>_querycache
1.  object <span class="apidocSignatureSpan">koa.request.</span>query
1.  string <span class="apidocSignatureSpan">koa.request.</span>querystring
1.  string <span class="apidocSignatureSpan">koa.request.</span>search

#### [module koa.response](#apidoc.module.koa.response)
1.  [function <span class="apidocSignatureSpan">koa.response.</span>append (field, val)](#apidoc.element.koa.response.append)
1.  [function <span class="apidocSignatureSpan">koa.response.</span>attachment (filename)](#apidoc.element.koa.response.attachment)
1.  [function <span class="apidocSignatureSpan">koa.response.</span>flushHeaders ()](#apidoc.element.koa.response.flushHeaders)
1.  [function <span class="apidocSignatureSpan">koa.response.</span>get (field)](#apidoc.element.koa.response.get)
1.  [function <span class="apidocSignatureSpan">koa.response.</span>inspect ()](#apidoc.element.koa.response.inspect)
1.  [function <span class="apidocSignatureSpan">koa.response.</span>is (types)](#apidoc.element.koa.response.is)
1.  [function <span class="apidocSignatureSpan">koa.response.</span>redirect (url, alt)](#apidoc.element.koa.response.redirect)
1.  [function <span class="apidocSignatureSpan">koa.response.</span>remove (field)](#apidoc.element.koa.response.remove)
1.  [function <span class="apidocSignatureSpan">koa.response.</span>set (field, val)](#apidoc.element.koa.response.set)
1.  [function <span class="apidocSignatureSpan">koa.response.</span>toJSON ()](#apidoc.element.koa.response.toJSON)
1.  [function <span class="apidocSignatureSpan">koa.response.</span>vary (field)](#apidoc.element.koa.response.vary)



# <a name="apidoc.module.koa"></a>[module koa](#apidoc.module.koa)



# <a name="apidoc.module.koa.context"></a>[module koa.context](#apidoc.module.koa.context)

#### <a name="apidoc.element.koa.context.accepts"></a>[function <span class="apidocSignatureSpan">koa.context.</span>accepts ()](#apidoc.element.koa.context.accepts)
- description and source-code
```javascript
accepts = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
...
http requests which delegate to an [IncomingMessage](https://nodejs.org/api/http.html#http_class_http_incomingmessage)
from the node 'http' module.

Here is an example of checking that a requesting client supports xml.

'''js
app.use(async (ctx, next) => {
  ctx.assert(ctx.request.accepts('xml'), 406);
  // equivalent to:
  // if (!ctx.request.accepts('xml')) ctx.throw(406);
  await next();
});
'''

Koa provides a 'Response' object as the 'response' property of the 'Context'.
...
```

#### <a name="apidoc.element.koa.context.acceptsCharsets"></a>[function <span class="apidocSignatureSpan">koa.context.</span>acceptsCharsets ()](#apidoc.element.koa.context.acceptsCharsets)
- description and source-code
```javascript
acceptsCharsets = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
n/a
```

#### <a name="apidoc.element.koa.context.acceptsEncodings"></a>[function <span class="apidocSignatureSpan">koa.context.</span>acceptsEncodings ()](#apidoc.element.koa.context.acceptsEncodings)
- description and source-code
```javascript
acceptsEncodings = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
n/a
```

#### <a name="apidoc.element.koa.context.acceptsLanguages"></a>[function <span class="apidocSignatureSpan">koa.context.</span>acceptsLanguages ()](#apidoc.element.koa.context.acceptsLanguages)
- description and source-code
```javascript
acceptsLanguages = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
n/a
```

#### <a name="apidoc.element.koa.context.append"></a>[function <span class="apidocSignatureSpan">koa.context.</span>append ()](#apidoc.element.koa.context.append)
- description and source-code
```javascript
append = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
...

  /**
* Append additional header 'field' with value 'val'.
*
* Examples:
*
* '''
* this.append('Link', ['<http://localhost/>', '<http://localhost:3000/>']);
* this.append('Set-Cookie', 'foo=bar; Path=/; HttpOnly');
* this.append('Warning', '199 Miscellaneous warning');
* '''
*
* @param {String} field
* @param {String|Array} val
* @api public
...
```

#### <a name="apidoc.element.koa.context.assert"></a>[function <span class="apidocSignatureSpan">koa.context.</span>assert (value, status, msg, opts)](#apidoc.element.koa.context.assert)
- description and source-code
```javascript
function assert(value, status, msg, opts) {
  if (value) return;
  throw createError(status, msg, opts);
}
```
- example usage
```shell
...
http requests which delegate to an [IncomingMessage](https://nodejs.org/api/http.html#http_class_http_incomingmessage)
from the node 'http' module.

Here is an example of checking that a requesting client supports xml.

'''js
app.use(async (ctx, next) => {
  ctx.assert(ctx.request.accepts('xml'), 406);
  // equivalent to:
  // if (!ctx.request.accepts('xml')) ctx.throw(406);
  await next();
});
'''

Koa provides a 'Response' object as the 'response' property of the 'Context'.
...
```

#### <a name="apidoc.element.koa.context.attachment"></a>[function <span class="apidocSignatureSpan">koa.context.</span>attachment ()](#apidoc.element.koa.context.attachment)
- description and source-code
```javascript
attachment = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
n/a
```

#### <a name="apidoc.element.koa.context.flushHeaders"></a>[function <span class="apidocSignatureSpan">koa.context.</span>flushHeaders ()](#apidoc.element.koa.context.flushHeaders)
- description and source-code
```javascript
flushHeaders = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
...
    ]);
  },

  /**
   * Flush any set headers, and begin the body
   */
  flushHeaders() {
    this.res.flushHeaders();
  }
};
...
```

#### <a name="apidoc.element.koa.context.get"></a>[function <span class="apidocSignatureSpan">koa.context.</span>get ()](#apidoc.element.koa.context.get)
- description and source-code
```javascript
get = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
...
 *
 * @return {String} hostname:port
 * @api public
 */

get host() {
  const proxy = this.app.proxy;
  let host = proxy && this.get('X-Forwarded-Host');
  host = host || this.get('Host');
  if (!host) return '';
  return host.split(/\s*,\s*/)[0];
},

/**
 * Parse the "Host" header field hostname
...
```

#### <a name="apidoc.element.koa.context.inspect"></a>[function <span class="apidocSignatureSpan">koa.context.</span>inspect ()](#apidoc.element.koa.context.inspect)
- description and source-code
```javascript
inspect() {
  return this.toJSON();
}
```
- example usage
```shell
...
/**
 * Context prototype.
 */

const proto = module.exports = {

/**
 * util.inspect() implementation, which
 * just returns the JSON output.
 *
 * @return {Object}
 * @api public
 */

inspect() {
...
```

#### <a name="apidoc.element.koa.context.is"></a>[function <span class="apidocSignatureSpan">koa.context.</span>is ()](#apidoc.element.koa.context.is)
- description and source-code
```javascript
is = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
...
* If there is no request body, 'null' is returned.
* If there is no content type, 'false' is returned.
* Otherwise, it returns the first 'type' that matches.
*
* Examples:
*
*     // With Content-Type: text/html; charset=utf-8
*     this.is('html'); // => 'html'
*     this.is('text/html'); // => 'text/html'
*     this.is('text/*', 'application/json'); // => 'text/html'
*
*     // When Content-Type is application/json
*     this.is('json', 'urlencoded'); // => 'json'
*     this.is('application/json'); // => 'application/json'
*     this.is('html', 'application/*'); // => 'application/json'
...
```

#### <a name="apidoc.element.koa.context.onerror"></a>[function <span class="apidocSignatureSpan">koa.context.</span>onerror (err)](#apidoc.element.koa.context.onerror)
- description and source-code
```javascript
onerror(err) {
  // don't do anything if there is no error.
  // this allows you to pass 'this.onerror'
  // to node-style callbacks.
  if (null == err) return;

  if (!(err instanceof Error)) err = new Error('non-error thrown: ${err}');

  let headerSent = false;
  if (this.headerSent || !this.writable) {
    headerSent = err.headerSent = true;
  }

  // delegate
  this.app.emit('error', err, this);

  // nothing we can do here other
  // than delegate to the app-level
  // handler and log.
  if (headerSent) {
    return;
  }

  const { res } = this;

  // first unset all headers
  if (typeof res.getHeaderNames === 'function') {
    res.getHeaderNames().forEach(name => res.removeHeader(name));
  } else {
    res._headers = {}; // Node < 7.7
  }

  // then set those specified
  this.set(err.headers);

  // force text/plain
  this.type = 'text';

  // ENOENT support
  if ('ENOENT' == err.code) err.status = 404;

  // default to 500
  if ('number' != typeof err.status || !statuses[err.status]) err.status = 500;

  // respond
  const code = statuses[err.status];
  const msg = err.expose ? err.message : code;
  this.status = err.status;
  this.length = Buffer.byteLength(msg);
  this.res.end(msg);
}
```
- example usage
```shell
...
  this.length = val.length;
  return;
}

// stream
if ('function' == typeof val.pipe) {
  onFinish(this.res, destroy.bind(null, val));
  ensureErrorHandler(val, err => this.ctx.onerror(err));

  // overwriting
  if (null != original && original != val) this.remove('Content-Length');

  if (setType) this.type = 'bin';
  return;
}
...
```

#### <a name="apidoc.element.koa.context.redirect"></a>[function <span class="apidocSignatureSpan">koa.context.</span>redirect ()](#apidoc.element.koa.context.redirect)
- description and source-code
```javascript
redirect = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
...
*
* The string "back" is special-cased
* to provide Referrer support, when Referrer
* is not present 'alt' or "/" is used.
*
* Examples:
*
*    this.redirect('back');
*    this.redirect('back', '/index.html');
*    this.redirect('/login');
*    this.redirect('http://google.com');
*
* @param {String} url
* @param {String} [alt]
* @api public
...
```

#### <a name="apidoc.element.koa.context.remove"></a>[function <span class="apidocSignatureSpan">koa.context.</span>remove ()](#apidoc.element.koa.context.remove)
- description and source-code
```javascript
remove = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
...
this._body = val;

if (this.res.headersSent) return;

// no content
if (null == val) {
  if (!statuses.empty[this.status]) this.status = 204;
  this.remove('Content-Type');
  this.remove('Content-Length');
  this.remove('Transfer-Encoding');
  return;
}

// set the status
if (!this._explicitStatus) this.status = 200;
...
```

#### <a name="apidoc.element.koa.context.set"></a>[function <span class="apidocSignatureSpan">koa.context.</span>set ()](#apidoc.element.koa.context.set)
- description and source-code
```javascript
set = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
...
if (typeof res.getHeaderNames === 'function') {
  res.getHeaderNames().forEach(name => res.removeHeader(name));
} else {
  res._headers = {}; // Node < 7.7
}

// then set those specified
this.set(err.headers);

// force text/plain
this.type = 'text';

// ENOENT support
if ('ENOENT' == err.code) err.status = 404;
...
```

#### <a name="apidoc.element.koa.context.throw"></a>[function <span class="apidocSignatureSpan">koa.context.</span>throw ()](#apidoc.element.koa.context.throw)
- description and source-code
```javascript
throw() {
  throw createError.apply(null, arguments);
}
```
- example usage
```shell
...

Here is an example of checking that a requesting client supports xml.

'''js
app.use(async (ctx, next) => {
  ctx.assert(ctx.request.accepts('xml'), 406);
  // equivalent to:
  // if (!ctx.request.accepts('xml')) ctx.throw(406);
  await next();
});
'''

Koa provides a 'Response' object as the 'response' property of the 'Context'.
Koa's 'Response' object provides helpful methods for working with
http responses which delegate to a [ServerResponse](https://nodejs.org/api/http.html#http_class_http_serverresponse)
...
```

#### <a name="apidoc.element.koa.context.toJSON"></a>[function <span class="apidocSignatureSpan">koa.context.</span>toJSON ()](#apidoc.element.koa.context.toJSON)
- description and source-code
```javascript
toJSON() {
  return {
    request: this.request.toJSON(),
    response: this.response.toJSON(),
    app: this.app.toJSON(),
    originalUrl: this.originalUrl,
    req: '<original node req>',
    res: '<original node res>',
    socket: '<original node socket>'
  };
}
```
- example usage
```shell
...
 * just returns the JSON output.
 *
 * @return {Object}
 * @api public
 */

inspect() {
  return this.toJSON();
},

/**
 * Return JSON representation.
 *
 * Here we explicitly invoke .toJSON() on each
 * object, as iteration will otherwise fail due
...
```

#### <a name="apidoc.element.koa.context.vary"></a>[function <span class="apidocSignatureSpan">koa.context.</span>vary ()](#apidoc.element.koa.context.vary)
- description and source-code
```javascript
vary = function (){
  return this[target][name].apply(this[target], arguments);
}
```
- example usage
```shell
n/a
```



# <a name="apidoc.module.koa.request"></a>[module koa.request](#apidoc.module.koa.request)

#### <a name="apidoc.element.koa.request.accepts"></a>[function <span class="apidocSignatureSpan">koa.request.</span>accepts ()](#apidoc.element.koa.request.accepts)
- description and source-code
```javascript
accepts() {
  return this.accept.types.apply(this.accept, arguments);
}
```
- example usage
```shell
...
http requests which delegate to an [IncomingMessage](https://nodejs.org/api/http.html#http_class_http_incomingmessage)
from the node 'http' module.

Here is an example of checking that a requesting client supports xml.

'''js
app.use(async (ctx, next) => {
  ctx.assert(ctx.request.accepts('xml'), 406);
  // equivalent to:
  // if (!ctx.request.accepts('xml')) ctx.throw(406);
  await next();
});
'''

Koa provides a 'Response' object as the 'response' property of the 'Context'.
...
```

#### <a name="apidoc.element.koa.request.acceptsCharsets"></a>[function <span class="apidocSignatureSpan">koa.request.</span>acceptsCharsets ()](#apidoc.element.koa.request.acceptsCharsets)
- description and source-code
```javascript
acceptsCharsets() {
  return this.accept.charsets.apply(this.accept, arguments);
}
```
- example usage
```shell
n/a
```

#### <a name="apidoc.element.koa.request.acceptsEncodings"></a>[function <span class="apidocSignatureSpan">koa.request.</span>acceptsEncodings ()](#apidoc.element.koa.request.acceptsEncodings)
- description and source-code
```javascript
acceptsEncodings() {
  return this.accept.encodings.apply(this.accept, arguments);
}
```
- example usage
```shell
n/a
```

#### <a name="apidoc.element.koa.request.acceptsLanguages"></a>[function <span class="apidocSignatureSpan">koa.request.</span>acceptsLanguages ()](#apidoc.element.koa.request.acceptsLanguages)
- description and source-code
```javascript
acceptsLanguages() {
  return this.accept.languages.apply(this.accept, arguments);
}
```
- example usage
```shell
n/a
```

#### <a name="apidoc.element.koa.request.get"></a>[function <span class="apidocSignatureSpan">koa.request.</span>get (field)](#apidoc.element.koa.request.get)
- description and source-code
```javascript
get(field) {
  const req = this.req;
  switch (field = field.toLowerCase()) {
    case 'referer':
    case 'referrer':
      return req.headers.referrer || req.headers.referer || '';
    default:
      return req.headers[field] || '';
  }
}
```
- example usage
```shell
...
 *
 * @return {String} hostname:port
 * @api public
 */

get host() {
  const proxy = this.app.proxy;
  let host = proxy && this.get('X-Forwarded-Host');
  host = host || this.get('Host');
  if (!host) return '';
  return host.split(/\s*,\s*/)[0];
},

/**
 * Parse the "Host" header field hostname
...
```

#### <a name="apidoc.element.koa.request.inspect"></a>[function <span class="apidocSignatureSpan">koa.request.</span>inspect ()](#apidoc.element.koa.request.inspect)
- description and source-code
```javascript
inspect() {
  if (!this.req) return;
  return this.toJSON();
}
```
- example usage
```shell
...
/**
 * Context prototype.
 */

const proto = module.exports = {

/**
 * util.inspect() implementation, which
 * just returns the JSON output.
 *
 * @return {Object}
 * @api public
 */

inspect() {
...
```

#### <a name="apidoc.element.koa.request.is"></a>[function <span class="apidocSignatureSpan">koa.request.</span>is (types)](#apidoc.element.koa.request.is)
- description and source-code
```javascript
is(types) {
  if (!types) return typeis(this.req);
  if (!Array.isArray(types)) types = [].slice.call(arguments);
  return typeis(this.req, types);
}
```
- example usage
```shell
...
* If there is no request body, 'null' is returned.
* If there is no content type, 'false' is returned.
* Otherwise, it returns the first 'type' that matches.
*
* Examples:
*
*     // With Content-Type: text/html; charset=utf-8
*     this.is('html'); // => 'html'
*     this.is('text/html'); // => 'text/html'
*     this.is('text/*', 'application/json'); // => 'text/html'
*
*     // When Content-Type is application/json
*     this.is('json', 'urlencoded'); // => 'json'
*     this.is('application/json'); // => 'application/json'
*     this.is('html', 'application/*'); // => 'application/json'
...
```

#### <a name="apidoc.element.koa.request.toJSON"></a>[function <span class="apidocSignatureSpan">koa.request.</span>toJSON ()](#apidoc.element.koa.request.toJSON)
- description and source-code
```javascript
toJSON() {
  return only(this, [
    'method',
    'url',
    'header'
  ]);
}
```
- example usage
```shell
...
 * just returns the JSON output.
 *
 * @return {Object}
 * @api public
 */

inspect() {
  return this.toJSON();
},

/**
 * Return JSON representation.
 *
 * Here we explicitly invoke .toJSON() on each
 * object, as iteration will otherwise fail due
...
```



# <a name="apidoc.module.koa.response"></a>[module koa.response](#apidoc.module.koa.response)

#### <a name="apidoc.element.koa.response.append"></a>[function <span class="apidocSignatureSpan">koa.response.</span>append (field, val)](#apidoc.element.koa.response.append)
- description and source-code
```javascript
append(field, val) {
  const prev = this.get(field);

  if (prev) {
    val = Array.isArray(prev)
      ? prev.concat(val)
      : [prev].concat(val);
  }

  return this.set(field, val);
}
```
- example usage
```shell
...

  /**
* Append additional header 'field' with value 'val'.
*
* Examples:
*
* '''
* this.append('Link', ['<http://localhost/>', '<http://localhost:3000/>']);
* this.append('Set-Cookie', 'foo=bar; Path=/; HttpOnly');
* this.append('Warning', '199 Miscellaneous warning');
* '''
*
* @param {String} field
* @param {String|Array} val
* @api public
...
```

#### <a name="apidoc.element.koa.response.attachment"></a>[function <span class="apidocSignatureSpan">koa.response.</span>attachment (filename)](#apidoc.element.koa.response.attachment)
- description and source-code
```javascript
attachment(filename) {
  if (filename) this.type = extname(filename);
  this.set('Content-Disposition', contentDisposition(filename));
}
```
- example usage
```shell
n/a
```

#### <a name="apidoc.element.koa.response.flushHeaders"></a>[function <span class="apidocSignatureSpan">koa.response.</span>flushHeaders ()](#apidoc.element.koa.response.flushHeaders)
- description and source-code
```javascript
flushHeaders() {
  this.res.flushHeaders();
}
```
- example usage
```shell
...
    ]);
  },

  /**
   * Flush any set headers, and begin the body
   */
  flushHeaders() {
    this.res.flushHeaders();
  }
};
...
```

#### <a name="apidoc.element.koa.response.get"></a>[function <span class="apidocSignatureSpan">koa.response.</span>get (field)](#apidoc.element.koa.response.get)
- description and source-code
```javascript
get(field) {
  return this.header[field.toLowerCase()] || '';
}
```
- example usage
```shell
...
 *
 * @return {String} hostname:port
 * @api public
 */

get host() {
  const proxy = this.app.proxy;
  let host = proxy && this.get('X-Forwarded-Host');
  host = host || this.get('Host');
  if (!host) return '';
  return host.split(/\s*,\s*/)[0];
},

/**
 * Parse the "Host" header field hostname
...
```

#### <a name="apidoc.element.koa.response.inspect"></a>[function <span class="apidocSignatureSpan">koa.response.</span>inspect ()](#apidoc.element.koa.response.inspect)
- description and source-code
```javascript
inspect() {
  if (!this.res) return;
  const o = this.toJSON();
  o.body = this.body;
  return o;
}
```
- example usage
```shell
...
/**
 * Context prototype.
 */

const proto = module.exports = {

/**
 * util.inspect() implementation, which
 * just returns the JSON output.
 *
 * @return {Object}
 * @api public
 */

inspect() {
...
```

#### <a name="apidoc.element.koa.response.is"></a>[function <span class="apidocSignatureSpan">koa.response.</span>is (types)](#apidoc.element.koa.response.is)
- description and source-code
```javascript
is(types) {
  const type = this.type;
  if (!types) return type || false;
  if (!Array.isArray(types)) types = [].slice.call(arguments);
  return typeis(type, types);
}
```
- example usage
```shell
...
* If there is no request body, 'null' is returned.
* If there is no content type, 'false' is returned.
* Otherwise, it returns the first 'type' that matches.
*
* Examples:
*
*     // With Content-Type: text/html; charset=utf-8
*     this.is('html'); // => 'html'
*     this.is('text/html'); // => 'text/html'
*     this.is('text/*', 'application/json'); // => 'text/html'
*
*     // When Content-Type is application/json
*     this.is('json', 'urlencoded'); // => 'json'
*     this.is('application/json'); // => 'application/json'
*     this.is('html', 'application/*'); // => 'application/json'
...
```

#### <a name="apidoc.element.koa.response.redirect"></a>[function <span class="apidocSignatureSpan">koa.response.</span>redirect (url, alt)](#apidoc.element.koa.response.redirect)
- description and source-code
```javascript
redirect(url, alt) {
  // location
  if ('back' == url) url = this.ctx.get('Referrer') || alt || '/';
  this.set('Location', url);

  // status
  if (!statuses.redirect[this.status]) this.status = 302;

  // html
  if (this.ctx.accepts('html')) {
    url = escape(url);
    this.type = 'text/html; charset=utf-8';
    this.body = 'Redirecting to <a href="${url}">${url}</a>.';
    return;
  }

  // text
  this.type = 'text/plain; charset=utf-8';
  this.body = 'Redirecting to ${url}.';
}
```
- example usage
```shell
...
*
* The string "back" is special-cased
* to provide Referrer support, when Referrer
* is not present 'alt' or "/" is used.
*
* Examples:
*
*    this.redirect('back');
*    this.redirect('back', '/index.html');
*    this.redirect('/login');
*    this.redirect('http://google.com');
*
* @param {String} url
* @param {String} [alt]
* @api public
...
```

#### <a name="apidoc.element.koa.response.remove"></a>[function <span class="apidocSignatureSpan">koa.response.</span>remove (field)](#apidoc.element.koa.response.remove)
- description and source-code
```javascript
remove(field) {
  this.res.removeHeader(field);
}
```
- example usage
```shell
...
this._body = val;

if (this.res.headersSent) return;

// no content
if (null == val) {
  if (!statuses.empty[this.status]) this.status = 204;
  this.remove('Content-Type');
  this.remove('Content-Length');
  this.remove('Transfer-Encoding');
  return;
}

// set the status
if (!this._explicitStatus) this.status = 200;
...
```

#### <a name="apidoc.element.koa.response.set"></a>[function <span class="apidocSignatureSpan">koa.response.</span>set (field, val)](#apidoc.element.koa.response.set)
- description and source-code
```javascript
set(field, val) {
  if (2 == arguments.length) {
    if (Array.isArray(val)) val = val.map(String);
    else val = String(val);
    this.res.setHeader(field, val);
  } else {
    for (const key in field) {
      this.set(key, field[key]);
    }
  }
}
```
- example usage
```shell
...
if (typeof res.getHeaderNames === 'function') {
  res.getHeaderNames().forEach(name => res.removeHeader(name));
} else {
  res._headers = {}; // Node < 7.7
}

// then set those specified
this.set(err.headers);

// force text/plain
this.type = 'text';

// ENOENT support
if ('ENOENT' == err.code) err.status = 404;
...
```

#### <a name="apidoc.element.koa.response.toJSON"></a>[function <span class="apidocSignatureSpan">koa.response.</span>toJSON ()](#apidoc.element.koa.response.toJSON)
- description and source-code
```javascript
toJSON() {
  return only(this, [
    'status',
    'message',
    'header'
  ]);
}
```
- example usage
```shell
...
 * just returns the JSON output.
 *
 * @return {Object}
 * @api public
 */

inspect() {
  return this.toJSON();
},

/**
 * Return JSON representation.
 *
 * Here we explicitly invoke .toJSON() on each
 * object, as iteration will otherwise fail due
...
```

#### <a name="apidoc.element.koa.response.vary"></a>[function <span class="apidocSignatureSpan">koa.response.</span>vary (field)](#apidoc.element.koa.response.vary)
- description and source-code
```javascript
vary(field) {
  vary(this.res, field);
}
```
- example usage
```shell
n/a
```



# misc
- this document was created with [utility2](https://github.com/kaizhu256/node-utility2)
